(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-52989e8e"],{"28a5":function(t,e,r){"use strict";var n=r("aae3"),a=r("cb7c"),o=r("ebd6"),s=r("0390"),i=r("9def"),l=r("5f1b"),c=r("520a"),u=r("79e5"),m=Math.min,d=[].push,f="split",h="length",p="lastIndex",g=4294967295,b=!u((function(){RegExp(g,"y")}));r("214f")("split",2,(function(t,e,r,u){var v;return v="c"=="abbc"[f](/(b)*/)[1]||4!="test"[f](/(?:)/,-1)[h]||2!="ab"[f](/(?:ab)*/)[h]||4!="."[f](/(.?)(.?)/)[h]||"."[f](/()()/)[h]>1||""[f](/.?/)[h]?function(t,e){var a=String(this);if(void 0===t&&0===e)return[];if(!n(t))return r.call(a,t,e);var o,s,i,l=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),m=0,f=void 0===e?g:e>>>0,b=new RegExp(t.source,u+"g");while(o=c.call(b,a)){if(s=b[p],s>m&&(l.push(a.slice(m,o.index)),o[h]>1&&o.index<a[h]&&d.apply(l,o.slice(1)),i=o[0][h],m=s,l[h]>=f))break;b[p]===o.index&&b[p]++}return m===a[h]?!i&&b.test("")||l.push(""):l.push(a.slice(m)),l[h]>f?l.slice(0,f):l}:"0"[f](void 0,0)[h]?function(t,e){return void 0===t&&0===e?[]:r.call(this,t,e)}:r,[function(r,n){var a=t(this),o=void 0==r?void 0:r[e];return void 0!==o?o.call(r,a,n):v.call(String(a),r,n)},function(t,e){var n=u(v,t,this,e,v!==r);if(n.done)return n.value;var c=a(t),d=String(this),f=o(c,RegExp),h=c.unicode,p=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(b?"y":"g"),I=new f(b?c:"^(?:"+c.source+")",p),y=void 0===e?g:e>>>0;if(0===y)return[];if(0===d.length)return null===l(I,d)?[d]:[];var k=0,x=0,R=[];while(x<d.length){I.lastIndex=b?x:0;var j,O=l(I,b?d:d.slice(x));if(null===O||(j=m(i(I.lastIndex+(b?0:x)),d.length))===k)x=s(d,x,h);else{if(R.push(d.slice(k,x)),R.length===y)return R;for(var w=1;w<=O.length-1;w++)if(R.push(O[w]),R.length===y)return R;x=k=j}}return R.push(d.slice(k)),R}]}))},"325c":function(t,e,r){"use strict";r.d(e,"b",(function(){return n})),r.d(e,"a",(function(){return a}));r("ac6a"),r("456d"),r("28a5"),r("3b2b"),r("a481"),r("6b54");function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-MM-dd hh:mm:ss";if(t=new Date(t),"Invalid Date"===t.toString())return"";/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));var r={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};for(var n in r)if(new RegExp("(".concat(n,")")).test(e)){var a=r[n]+"";e=e.replace(RegExp.$1,1===RegExp.$1.length?a:("00"+a).slice(a.length))}return e}function a(t,e){return t.reduce((function(t,r){return t.concat(Array.isArray(r[e])?[].concat(r).concat(a(r[e],e)):r)}),[])}},7368:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{staticClass:"userList ",attrs:{bordered:!1,"dis-hover":""}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v("系统用户")]),r("Row",{staticClass:"mb10",attrs:{type:"flex",justify:"end",align:"middle"}},[r("Col",{staticStyle:{flex:"1"}},[r("Button",{staticClass:"fl",attrs:{type:"success",icon:"md-add"},on:{click:function(e){t.modal=!0}}},[t._v("新增用户")])],1),r("Col",[r("Input",{staticClass:"w220 mr10",attrs:{placeholder:"name",clearable:""},model:{value:t.searchParam.name,callback:function(e){t.$set(t.searchParam,"name","string"===typeof e?e.trim():e)},expression:"searchParam.name"}}),r("Input",{staticClass:"w220 mr10",attrs:{placeholder:"mobile",clearable:""},model:{value:t.searchParam.mobile,callback:function(e){t.$set(t.searchParam,"mobile","string"===typeof e?e.trim():e)},expression:"searchParam.mobile"}})],1),r("Col",[r("Button",{attrs:{type:"primary",icon:"ios-search",loading:t.loading},on:{click:function(e){return t.getList(1)}}},[t._v("查询")])],1)],1),r("Table",{staticClass:"mt20",attrs:{columns:t.columns,data:t.data,loading:t.loading,size:"small"}}),r("Row",{staticClass:"mt10",attrs:{type:"flex",justify:"end",align:"middle"}},[r("Page",{attrs:{total:t.searchParam.total,"page-size":t.searchParam.pageSize,current:t.searchParam.pageNum},on:{"update:current":function(e){return t.$set(t.searchParam,"pageNum",e)},"on-change":t.getList}})],1),r("Modal",{attrs:{title:"新增用户"},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[r("Form",{ref:"form",attrs:{model:t.formItem,rules:t.userRules,"label-width":80}},[r("FormItem",{attrs:{label:"用户名",prop:"name"}},[r("Input",{attrs:{placeholder:"请输入用户名"},model:{value:t.formItem.name,callback:function(e){t.$set(t.formItem,"name","string"===typeof e?e.trim():e)},expression:"formItem.name"}})],1),r("FormItem",{attrs:{label:"描述",prop:"desc"}},[r("Input",{attrs:{placeholder:"请输入描述"},model:{value:t.formItem.desc,callback:function(e){t.$set(t.formItem,"desc","string"===typeof e?e.trim():e)},expression:"formItem.desc"}})],1),r("FormItem",{attrs:{label:"备注",prop:"remark"}},[r("Input",{attrs:{placeholder:"请输入备注"},model:{value:t.formItem.remark,callback:function(e){t.$set(t.formItem,"remark","string"===typeof e?e.trim():e)},expression:"formItem.remark"}})],1),r("FormItem",{attrs:{label:"状态",prop:"status"}},[r("Select",{attrs:{placeholder:"请选择用户状态"},model:{value:t.formItem.status,callback:function(e){t.$set(t.formItem,"status",e)},expression:"formItem.status"}},[r("Option",{attrs:{value:0}},[t._v("启用")]),r("Option",{attrs:{value:1}},[t._v("不启用")])],1)],1)],1),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{on:{click:function(e){t.modal=!1}}},[t._v("取消")]),r("Button",{attrs:{type:"primary"},on:{click:t.saveOrUpdateUser}},[t._v("确定")])],1)],1),r("Modal",{attrs:{title:"授予角色"},model:{value:t.role_modal,callback:function(e){t.role_modal=e},expression:"role_modal"}},[r("Transfer",{attrs:{filterable:"",titles:["所有角色","已授权角色"],data:t.roleList,"target-keys":t.targetRoles,"render-format":t.renderTransfer,"list-style":{minWidth:"212px",minHeight:"340px"}},on:{"on-change":t.transferChange}}),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{on:{click:function(e){t.role_modal=!1}}},[t._v("取消")]),r("Button",{attrs:{type:"primary"},on:{click:t.saveUserRole}},[t._v("确定")])],1)],1)],1)},a=[],o=(r("c5f6"),r("456d"),r("ac6a"),r("7f7f"),r("c24f")),s=r("325c"),i={name:"UserList",data:function(){var t=this;return{modal:!1,role_modal:!1,loading:!1,searchParam:{name:"",mobile:"",pageNum:1,pageSize:10,total:0},columns:[{title:"ID",minWidth:50,key:"id"},{title:"名称",minWidth:120,key:"name"},{title:"所属角色",minWidth:120,key:"role",render:function(t,e){return t("span",e.row.roles.map((function(t){return t.name})).join(","))}},{title:"创建时间",minWidth:100,key:"created_at",render:function(t,e){return t("span",Object(s["b"])(e.row.created_at))}},{title:"操作",key:"action",width:180,fixed:"right",render:function(e,r){var n=r.row;return e("div","admin"===n.name?"":[e("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:function(){return t.edit(n)}}},"编辑"),e("Button",{props:{type:"success",size:"small"},style:{marginRight:"5px"},on:{click:function(){return t.auth(n)}}},"授权"),e("Poptip",{props:{transfer:!0,confirm:!0,title:"你确定删除此用户？"},on:{"on-ok":function(){return t.dele(n)}}},[e("Button",{props:{type:"error",size:"small"}},"删除")])])}}],data:[],formItem:{name:"",desc:"",remark:"",status:0},userRules:{name:[{required:!0,trigger:"blur",message:"用户名必填"}],status:[{required:!0,type:"number",trigger:"change",message:"启用状态必选"}]},authUserId:"",roleList:[],targetRoles:[]}},created:function(){},methods:{getRoleList:function(){var t=this;Object(o["d"])().then((function(e){t.roleList=e.map((function(t){return t.key=String(t.id),t}))}))},getList:function(t){var e=this;this.searchParam.pageNum=t||this.searchParam.pageNum,this.loading=!0,Object(o["g"])(this.searchParam).then((function(t){e.data=t.list,e.searchParam.total=t.total,e.loading=!1})).catch((function(t){e.loading=!1}))},saveOrUpdateUser:function(){var t=this;this.$refs["form"].validate((function(e){e?t.formItem.id?Object(o["m"])(t.formItem.id,t.formItem).then((function(e){t.getList(),t.modal=!1,t.resetFormItem()})):Object(o["j"])(t.formItem).then((function(e){t.getList(),t.modal=!1,t.resetFormItem()})):t.$Message.error("请检查表单填写")}))},edit:function(t){var e=this;this.formItem.id=t.id,Object.keys(this.formItem).forEach((function(r){e.formItem[r]=t[r]})),this.modal=!0},dele:function(t){var e=this,r=t.id;Object(o["c"])(r).then((function(t){return e.getList()}))},auth:function(t){this.authUserId=t.id,this.targetRoles=t.roles.map((function(t){return String(t.id)})),this.role_modal=!0},saveUserRole:function(){var t=this;Object(o["k"])(this.authUserId,this.targetRoles.map((function(t){return Number(t)}))).then((function(e){t.role_modal=!1,t.getList()}))},renderTransfer:function(t){return t.name+" - "+t.desc},transferChange:function(t){this.targetRoles=t},resetFormItem:function(){var t=this;delete this.formItem.id,Object.keys(this.formItem).forEach((function(e){t.formItem[e]=""})),this.formItem.status=0}}},l=i,c=r("2877"),u=Object(c["a"])(l,n,a,!1,null,null,null);e["default"]=u.exports},c24f:function(t,e,r){"use strict";r.d(e,"g",(function(){return a})),r.d(e,"j",(function(){return o})),r.d(e,"m",(function(){return s})),r.d(e,"c",(function(){return i})),r.d(e,"k",(function(){return l})),r.d(e,"f",(function(){return c})),r.d(e,"d",(function(){return u})),r.d(e,"h",(function(){return m})),r.d(e,"l",(function(){return d})),r.d(e,"b",(function(){return f})),r.d(e,"a",(function(){return h})),r.d(e,"e",(function(){return p})),r.d(e,"i",(function(){return g}));var n=r("cb4b");function a(t){return Object(n["a"])({url:"/users",method:"get",params:t})}function o(t){return Object(n["a"])({url:"/users",method:"post",data:t})}function s(t,e){return Object(n["a"])({url:"/users/".concat(t),method:"put",data:e})}function i(t){return Object(n["a"])({url:"/users/".concat(t),method:"delete"})}function l(t,e){return Object(n["a"])({url:"/users/setUserRoles",method:"post",data:{userId:t,roleIds:e}})}function c(t){return Object(n["a"])({url:"/roles",method:"get",params:t})}function u(){return Object(n["a"])({url:"/roles/getAllRoleList",method:"get"})}function m(t){return Object(n["a"])({url:"/roles",method:"post",data:t})}function d(t,e){return Object(n["a"])({url:"/roles/".concat(t),method:"put",data:e})}function f(t){return Object(n["a"])({url:"/roles/".concat(t),method:"delete"})}function h(t){return Object(n["a"])({url:"/roles/addResource",method:"post",data:{data:t}})}function p(t){return Object(n["a"])({url:"/roles/getResourcesByRole/".concat(t),method:"get"})}function g(t,e){return Object(n["a"])({url:"/roles/saveRoleResource/".concat(t),method:"post",data:{data:e}})}}}]);
//# sourceMappingURL=chunk-52989e8e.05df5f30.js.map